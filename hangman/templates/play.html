{% extends 'base.html' %}

{% block content %}
  <h1>Hangman</h1>
  <p>Attempts: {{ game.attempts }}</p>
  <p>Guessed Letters: {{ game.guessed_letters }}</p>

  <div id="hangman">
    <!-- Display Hangman stages based on the number of attempts -->
    {% if game.attempts >= 1 %}
      <img src="{{ url_for('static', filename='hangman/hangman1.png') }}" alt="Hangman Stage 1">
    {% endif %}
    {% if game.attempts >= 2 %}
      <img src="{{ url_for('static', filename='hangman/hangman2.png') }}" alt="Hangman Stage 2">
    {% endif %}
    <!-- Add more stages as needed -->

    <!-- Display the word with underscores for unguessed letters -->
    <p>
      {% for letter in game.word %}
        {% if letter in game.guessed_letters %}
          {{ letter }}
        {% else %}
          _
        {% endif %}
      {% endfor %}
    </p>
  </div>

  <form id="guessForm" method="post" action="{{ url_for('play_game', game_id=game.id) }}">
    <label for="letter">Guess a letter: </label>
    <input type="text" name="letter" id="letter" maxlength="1" required>
    <button type="button" onclick="submitGuess()">Submit</button>
  </form>

  <div id="message"></div>

  <script>
    function submitGuess() {
      var letterInput = document.getElementById('letter');
      var guessForm = document.getElementById('guessForm');
      var messageDiv = document.getElementById('message');

      // Validate input
      var letter = letterInput.value.trim().toLowerCase();
      if (/^[a-z]$/.test(letter)) {
        // Submit the form
        guessForm.submit();
      } else {
        // Display an error message
        messageDiv.innerHTML = '<p class="error">Please enter a valid single letter.</p>';
      }
    }
  </script>
{% endblock %}
